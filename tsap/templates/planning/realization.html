{% extends 'base.html' %}
{% load i18n %} {% load l10n %}
{% load static %}

{% block stylesheet %}
   <!-- <link rel="stylesheet" href="{% static 'css/awpr_table.css' %}"> -->
   <link rel="stylesheet" href="{% static 'css/forms.css' %}">
   <link rel="stylesheet" href="{% static 'css/dateselector.css' %}">
{% endblock %}

{% block script %}
    <script src="{% static 'js/emplhours.js' %}"></script>
{% endblock %}

{% block content %}
  {% if user.is_authenticated %}

        <div class="popup display_hide" >
            <span class="popuptext" id="id_msgbox"></span>
        </div>

        <div class="content_header">
            <div class="content_subheader_left">
                <h5 id="id_content_header_name" title="realization">{% trans 'Realization' %} </h5>
            </div>
            <div class="content_subheader_right"></div>
        </div>
        <div class="content_header">
            <div class="content_subheader_left">
                <input id="id_filter_name"
                       type="text"
                       class="fieldname pt-0 pb-0"

                       placeholder="{% trans 'filter...' %}">
            </div>
            <div class="content_subheader_right">
                <a id="id_btn_fill_rosterdate" class="btn btn-add">{% trans 'Fill rosterdate' %}</a>
                <a id="id_btn_add" class="btn btn-add">{% trans 'Add shift' %}</a>
                <a id="id_btn_delete" class="btn btn-add">{% trans 'Delete shift' %}</a>
            </div>
        </div>

        <div class="popup-container">
  <!-- =================== POPUP  =================== -->
            <div id="id_popup" class="popup_box display_hide td_width_360">
                <div class="popup-body">
                <table class="pop_tbl">
                    <thead>
                        <tr>
                            <td class="td_width_hours">{% trans "Day" %}</td>
                            <td class="td_width_hours"> {% trans "Hour" %}</td>
                            <td class="td_width_hours">{% trans "Minutes" %}</td>
                            <td class="td_width_hours">{% trans "am/pm" %}</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><select id="id_popup_days" class="td_width_hours"></select></td>
                            <td><select id="id_popup_hours" class="td_width_hours"></select></td>
                            <td><select id="id_popup_minutes" class="td_width_hours"></select></td>
                            <td><select id="id_popup_ampm" class="td_width_hours"></select></td>
                        </tr>
                    </tbody>
                </table>
                <div class="content_subheader_right">
                    <button class="popup_close btn btn-add">{% trans 'Cancel' %}</button>
                    <button id="id_popup_save" class="btn btn-add">{% trans 'Save' %}</button>
                </div>

                </div>
            </div>
  <!-- =================== END POPUP  =================== -->


            <table class="table table table-condensed tsa-tbl">
                <thead class="thead-inverse">
                <tr>
                    <th>{% trans 'Date' %}</th>
                    <th>{% trans 'Order' %}</th>
                    <th> {% trans 'Employee' %}</th>
                    <th td_width_120>{% trans 'Shift' %}</th>
                    <th >{% trans 'Start time' %}</th>
                    <th>{% trans 'End time' %}</th>
                    <th class="td_width_060">{% trans 'Break hours' %}</th>
                    <th class="td_width_120">{% trans 'Working hours' %}</th>
                    <th class="td_width_032"><img src="{% static 'img/stat04.png' %}" height="24" width="24"></th>
                </tr>
                </thead>
                <tbody id="id_tbody">
                    {% for item in items.all %}
                        <tr id="{{ item.pk }}">
                            <td>
                                <input data-name="rosterdate"
                                       type="date"
                                       autocomplete="off"
                                       ondragstart="return false;"
                                       ondrop="return false;"
                                       value="{{ item.rosterdate_yyyymmdd }}"
                                       o_value="{{ item.rosterdate_yyyymmdd}}"
                                       max="{{ record.datelast_str}}"
                                       class="input_text border_none" >
                            </td>
                            <td>
                                <input data-name="order"
                                       type="text"
                                       id="{{ item.order.code }}"
                                       list="id_datalist_orders"
                                       autocomplete="off"
                                       ondragstart="return false;"
                                       ondrop="return false;"
                                       maxlength="{{ item.maxlen_code }}"
                                       value="{{ item.orderhour.order.code|default_if_none:''}}"
                                       o_value="{{ item.orderhour.order.code|default_if_none:''}}"
                                       class="input_text border_none td_width_120" >
                            </td>
                            <td>
                                <input data-name="employee"
                                       type="text"
                                       id="{{ item.id_ordemplhour_empl }}"

                                       list="id_datalist_employees"
                                       autocomplete="off"
                                       ondragstart="return false;"
                                       ondrop="return false;"
                                       maxlength="{{ item.maxlen_code }}"
                                       value="{{ item.employee.code|default_if_none:''}}"
                                       o_value="{{ item.employee.code|default_if_none:''}}"
                                       class="input_text border_none td_width_120">
                            </td>
                            <td td_width_180>
                                {{ item.schemeitem.shift|default_if_none:''}}
                            </td>
                            <td class="input_popup td_width_120" data-name="timestart" data-value="{{ item.time_start_datetimelocal }}">
                                {{ item.timestartdhm }}
                             </td>
                            <td class="input_popup td_width_120" data-name="timeend" data-value="{{ item.timeend_datetimelocal }}">
                                {{ item.timeenddhm }}
                            </td>
                            <td class="td_width_060">
                                <input data-name="breakhours"
                                       type="text"
                                       autocomplete="off"
                                       ondragstart="return false;"
                                       ondrop="return false;"
                                       value="{{ item.breakhours}}"
                                       o_value="{{ item.breakhours}}"
                                       min="0"
                                       max="72"
                                       class="input_text border_none td_width_060" >
                            </td>
                            <td class="input_text td_width_060">
                                <input data-name="timeduration"
                                       type="text"
                                       autocomplete="off"
                                       ondragstart="return false;"
                                       ondrop="return false;"
                                       value="{{ item.time_hours}}"
                                       o_value="{{ item.time_hours}}"
                                       min="0"
                                       max="72"
                                       class="input_text border_none td_width_060" >
                            </td>
                            <td class="td_width_03p">
                                <a data-name="timestatus" href="#"
                                   value="{{ item.timestatus }}"
                                   class="input_icon">
                                    {% if item.timestatus == 5 %}
                                        <img src="{% static 'img/stat05.png' %}" height="24" width="24">
                                    {% else %}
                                        {% if item.timestatus == 4 %}
                                            <img src="{% static 'img/stat04.png' %}" height="24" width="24">
                                        {% else %}
                                            {% if item.timestatus == 3 %}
                                                <img src="{% static 'img/stat03.png' %}" height="24" width="24">
                                            {% else %}
                                                {% if item.timestatus == 2 %}
                                                    <img src="{% static 'img/stat02.png' %}" height="24" width="24">
                                                {% else %}
                                                    {% if item.timestatus == 1 %}
                                                        <img src="{% static 'img/stat01.png' %}" height="24" width="24">
                                                    {% else %}
                                                        <img src="{% static 'img/stat00.png' %}" height="24" width="24">
                                                    {% endif %}
                                                {% endif %}
                                            {% endif %}
                                        {% endif %}
                                    {% endif %}
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>


    <div id="id_data"
        data-imgsrc_inactive = "{% static 'img/inactive_black.png' %}"
        data-imgsrc_active = "{% static 'img/inactive_grey.png' %}"
        data-imgsrc_delete="{% static 'img/delete.gif' %}"
        data-imgsrc_stat00="{% static 'img/stat00.png' %}"
        data-imgsrc_stat01="{% static 'img/stat01.png' %}"
        data-imgsrc_stat02="{% static 'img/stat02.png' %}"
        data-imgsrc_stat03="{% static 'img/stat03.png' %}"
        data-imgsrc_stat04="{% static 'img/stat04.png' %}"
        data-imgsrc_stat05="{% static 'img/stat05.png' %}"
        data-lang ="{{ lang }}"
        data-interval ="{{ interval }}"
        data-timeformat ="{{ timeformat }}"
        data-weekdays ="{{ weekdays }}"
        data-url_fill_rosterdate= "{% url 'emplhour_fill_rosterdate_url' %}"
        data-url_emplhour_upload= "{% url 'emplhour_upload_url' %}"
        data-datalist_download_url= "{% url 'datalist_download_url' %}"
        data-err_msg01= "{% trans 'An error occurred.' %}"
        data-msg_confirm_del1= "{% trans 'Do you want to delete the shift of' %}"
        data-msg_confirm_del2= "{% trans 'Do you want to delete this shift?' %}"
    >
    </div>

    <datalist id="id_datalist_employees" class="nopadding"></datalist>
    <datalist id="id_datalist_orders" class="nopadding"></datalist>

  {% else %}
    <div class="alert alert-danger">{% trans 'Error' %}</div>
    <a href="{% url 'home' %}" class="btn btn-outline-primary">{% trans 'Cancel' %}</a>
  {% endif %}
{% endblock %}