{% extends 'base.html' %}
{% load i18n %} {% load l10n %}
{% load static %}

{% block title %}{% trans 'Roster' %}{% endblock %}

{% block script %}
    <script src="{% static 'js/roster.js' %}"></script>
    <script src="{% static 'js/timepicker.js' %}"></script>
{% endblock %}

<!-- SIDE BAR -->
{% block sidebar %}
    <nav id="id_sidebar" class="tsa_sidebar">
        <div class="sidebar_header">
            <h3>{% trans 'Roster' %}</h3>
        </div>
        <div class="td_width_200 mx-2 mt-2 mb-5">
            <h6 class="td_width_200 line_height_normal px-2">{% trans 'Select period' %}:</h6>
            <input id="id_flt_period"
                type="text"
                class="td_width_200 border_none pointer_show px-2"
                autocomplete="off"
                placeholder="{% trans 'Period' %}":
                readonly>
<!--
            <h6 class="td_width_200 line_height_normal mt-2 px-2">{% trans 'Select order' %}:</h6>
            <input id="id_flt_order"
                type="text"
                class="td_width_200 border_none pointer_show px-2"
                autocomplete="off"
                placeholder="{% trans 'Period' %}":
                readonly>
        </div>
-->
    </nav>
{% endblock %}
<!-- END SIDE BAR -->

<!-- MODAL -->
{% block modal %}
<!-- =================== MODAL STATUS  =================== -->
    <div class="modal " id="id_mod_status" tabindex="-1" role="dialog" aria-labelledby="id_modal_cont_label" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-md " role="document">
            <div class="modal-content">

                <div class="modal-header tsa_bc_lightlightgrey">
                    <h4 id="id_mod_status_header" class="modal-title mx-2" >{% trans 'Status' %}</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div  id="id_mod_status_body" class="modal-body">
                    <div class="modal_container">
                        <div class="modal_body_left">
                            <h6 class="modal-title mx-2" >{% trans 'Order' %}:</h6>
                        </div>
                        <div class="modal_body_right">
                            <h6 id="id_mod_status_order" class="modal-title mx-2" ></h6>
                        </div>
                    </div>
                    <div class="modal_container">
                        <div class="modal_body_left">
                            <h6 class="modal-title mx-2" >{% trans 'Employee' %}:</h6>
                        </div>
                        <div class="modal_body_right">
                            <h6 id="id_mod_status_employee" class="modal-title mx-2" ></h6>
                        </div>
                    </div>
                    <div class="modal_container">
                        <div class="modal_body_left">
                            <h6 class="modal-title mx-2" >{% trans 'Shift' %}:</h6>
                        </div>
                        <div class="modal_body_right">
                            <h6 id="id_mod_status_shift" class="modal-title mx-2" ></h6>
                        </div>
                    </div>
                     <div class="modal_container">
                        <div class="modal_body_left">
                            <h6 id="id_mod_status_time_label"class="modal-title mx-2" >{% trans 'Time' %}:</h6>
                        </div>
                        <div class="modal_body_right">
                            <h6 id="id_mod_status_time" class="modal-title mx-2" ></h6>
                        </div>
                    </div>

                    <div class="modal_container">
                        <div class="modal_body_left">
                            <div class="form-group">
                                <label for="id_mod_status_note" class="mx-2 my-2">{% trans 'Notes' %}:</label>
                                <input id="id_mod_status_note"
                                    type="textarea"
                                    autocomplete="off"
                                    ondragstart="return false;"
                                    ondrop="return false;"
                                    class="form-control">
                            </div>

                        </div>
                    </div>

                    <div class="modal_container">
                        <h6 id="id_mod_status_ftr_msg" class="modal-title mx-2"></h6>
                    </div>
                </div>

                <div class="modal-footer">
                    <button id="id_mod_status_btn_save" type="button" class="btn btn-primary">{% trans 'Confirm' %}</button>
                </div>

            </div>
        </div>
    </div>

<!-- =================== MODAL PERIOD  =================== -->
    <div class="modal fade" id="id_mod_period" tabindex="-1" role="dialog" aria-labelledby="id_modal_cont_label" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-md " role="document">
            <div class="modal-content">

                <div class="modal-header tsa_bc_lightlightgrey">
                    <h4 id="id_mod_period_header" class="modal-title mx-2" >{% trans 'Select period' %}</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div  id="id_mod_period_body" class="modal-body">
                    <h6 class="mx-2 my-1">{% trans 'Select an option' %}:</h6>
                    <div class="modal_container">
<!-- this div contains range select table -->
                        <div class="modal_body_left">
                            <div class="content_subheader_left mx-2 my-1">
                               <table class="table table-condensed tsa-tbl mx-1 my-1">
                                    <tbody id="id_mod_period_tblbody">
                                    </tbody>
                                </table>

                            </div>
                        </div>
                        <div class="modal_body_left">
                             <div class="form-group">
                                <label for="id_mod_period_datefirst" class="mx-2 my-1">{% trans 'Period start date' %}:</label>
                                <input id="id_mod_period_datefirst" type="date" class="form-control mx-2 my-1">
                                <label for="id_mod_period_datelast" class="mx-2 my-1">{% trans 'Period end date' %}:</label>
                                <input id="id_mod_period_datelast" type="date" class="form-control mx-2 my-1">
                             </div>
                        </div>
                    </div>

                        <h6 class="mx-2 my-1">{% trans 'Extend period with' %}:</h6>
                        <select id="id_mod_period_extend"
                               autocomplete="off"
                               ondragstart="return false;"
                               ondrop="return false;"
                               class="form-control">
                        </select>
                        <small class="mx-2 my-1">{% trans 'You can add up to 24 hours to the beginning and end of the period.' %}:</small>

                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">{% trans 'Cancel' %}</button>
                    <button id="id_mod_period_btn_save" type="button" class="btn btn-primary">{% trans 'Save' %}</button>
                </div>

            </div>
        </div>
    </div>

<!-- =================== MODAL ORDER  ===================
    <div class="modal fade" id="id_mod_order" tabindex="-1" role="dialog" aria-labelledby="id_modal_cont_label" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-md " role="document">
            <div class="modal-content">

                <div class="modal-header tsa_bc_lightlightgrey">
                    <h4 id="id_mod_order_header" class="modal-title mx-2" >{% trans 'Select customer and order' %}</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div  id="id_mod_order_body" class="modal-body">
                    <div class="modal_container">

                        <div class="modal_body_left">
                        <h6 class="mx-2 my-1">{% trans 'Select customer' %}:</h6>
                            <div class="content_subheader_left mx-2 my-1">

                                <table>
                                    <thead id="id_mod_order_thead_select_cust"class="mx-1 my-1 ">
                                        <tr>
                                            <td>
                                            <input id="id_mod_order_flt_select_cust"
                                                type="text"
                                                class="td_width_150 tsa_bc_transparent border_none px-2"
                                                autocomplete="off"
                                                placeholder="{% trans 'filter ...' %}">
                                            </td>

                                        </tr>
                                    </thead>
                                    <tbody id="id_mod_order_tblbody_cust"></tbody>
                                </table>
                            </div>
                        </div>
                        <div class="modal_body_left">
                            <h6 class="mx-2 my-1">{% trans 'Select order' %}:</h6>
                            <div class="content_subheader_left mx-2 my-1">
                                <table>
                                    <thead id="id_mod_order_thead_select_order"class="mx-1 my-1 ">
                                        <tr>
                                            <td>
                                            <input id="id_mod_order_flt_select_order"
                                                type="text"
                                                class="td_width_150 tsa_bc_transparent border_none px-2"
                                                autocomplete="off"
                                                placeholder="{% trans 'filter ...' %}">
                                            </td>
                                        </tr>
                                    </thead>
                                    <tbody id="id_mod_order_tblbody_order"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">{% trans 'Cancel' %}</button>
                    <button id="id_mod_order_btn_save" type="button" class="btn btn-primary">{% trans 'Save' %}</button>
                </div>

            </div>
        </div>
    </div>
-->


<!-- =================== MODAL EMPLOYEE  =================== -->
    <div class="modal fade" id="id_mod_employee" tabindex="-1" role="dialog" aria-labelledby="id_modal_cont_label" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg " role="document">
            <div class="modal-content">
                <div class="modal-header tsa_bc_lightlightgrey">
                    <h4 id="id_mod_employee_header" class="modal-title mx-2" >{% trans 'Employee' %}</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div  id="id_mod_employee_body" class="modal-body">
                    <div class="modal_container">

<!-- modal_body_left contains employee select table -->
                        <div class="modal_body_left">
                            <div class="content_subheader_left mx-2 my-1">
                                <div>
                                    <h6>{% trans 'Select employee' %}:</h6>
                                </div>

                                <div >
                                    <input id="id_mod_employee_filter_employee" type="text"
                                    class="fieldname pt-0 pb-0" colspan=2 autocomplete="off"
                                    placeholder="{% trans 'filter name...' %}"
                                    >
                                </div>
                                <div style="overflow-x:hidden;overflow-y:auto;height:400px;width:220px"> <!-- this div is necessary to get standard structure for FilterTableRows -->
                                    <table class="table table-condensed tsa-tbl mx-1 my-1">
                                        <tbody id="id_mod_employee_tblbody" data-table="employee">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div id="id_mod_employee_body_right"  class="modal_body_right mx-2 my-2">

                            <div class="mx-2 my-2 ">
                                <h6>{% trans 'Select an option' %}:</h6>
                            </div>

                            <div id="id_div_mod_buttons" class="btn-group btn-block mx-2 my-2" role="group" aria-label="Choose option" >
                                <button id="id_mod_employee_btn_absent" type="button"  class="btn btn-secondary ">{% trans 'Absence' %}</button>
                                <button id="id_mod_employee_btn_switch" type="button"  class="btn btn-secondary ">{% trans 'Switch shift' %}</button>
                                <button id="id_mod_employee_btn_split" type="button"  class="btn btn-secondary ">{% trans 'Split shift' %}</button>
                            </div>
                            <div class="text_align_center">
                                <img id="id_mod_employee_loader" src="{% static 'img/loader.gif' %}" height="24" width="24" class="display_hide" >
                            </div>
                            <div id="id_div_mod_absent" class="mod_flex mx-2 my-2 display_hide">
                                <div class="form-group">
                                    <label for="id_mod_employee_abscat" class="mx-2 my-2">{% trans 'Absence category' %}:</label>
                                    <select id="id_mod_employee_abscat"
                                           data-name="abscat"
                                           autocomplete="off"
                                           ondragstart="return false;"
                                           ondrop="return false;"
                                           class="form-control">
                                    </select>
                                </div>
                            </div>

                            <div id="id_div_mod_employee" class="mod_flex mx-2 my-2">
                                <div class="form-group">
                                    <label  id="id_label_mod_employee" for="id_mod_employee_input_employee" class="mx-2 my-2">{% trans 'Replacement employee' %}:</label>
                                    <input id="id_mod_employee_input_employee"
                                        type="text"
                                        autocomplete="off"
                                        ondragstart="return false;"
                                        ondrop="return false;"
                                        class="form-control"
                                        placeholder="{% trans 'Type a few letters and select employee in the list ...' %}">
                                </div>
                            </div>
                            <div id="id_div_mod_switch" class="mod_flex mx-2 my-2 display_hide">
                                <div class="form-group">
                                    <label for="id_mod_employee_switch_date" class="mx-2 my-2">{% trans 'Date of the shift to be switched with' %}:</label>
                                    <select id="id_mod_employee_switch_date" class="form-control">
                                    </select>

                                </div>
                                <div class="form-group">
                                    <label for="id_mod_employee_select_shift" class="mx-2 my-2">{% trans 'Select shift' %}:</label>
                                    <select id="id_mod_employee_select_shift" class="form-control">
                                    </select>
                                </div>

                            </div>
                            <div id="id_div_mod_split" class="mod_flex mx-2 my-2 display_hide">
                                <div class="form-group">
                                    <label for="id_mod_employee_split_time" class="mx-2 my-2">{% trans 'Split time' %}:</label>
                                    <input id="id_mod_employee_split_time" type="text" class="form-control">
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div id="id_mod_ftr_msg"></div>
                    <button id="id_mod_employee_btn_save" type="button" class="btn btn-primary">{% trans 'Save' %}</button>
                </div>

            </div>
        </div>
    </div>
<!-- =================== END MODAL EMPLOYEE  =================== -->
{% endblock %}
<!-- END MODAL -->

{% block content %}
    {% if user.is_authenticated %}

        <div class="popup display_hide" >
            <span class="popuptext" id="id_msgbox"></span>
        </div>
    <h1 class="mt-4"></h1>

   <!--   <div class="content_subheader_right"> -->
        <div class="content_header ">

            <div class="content_subheader_left mx-4 my-1">
                <h6></h6>
            </div>
            <img id="id_loader" src="{% static 'img/loader.gif' %}" height="24" width="24" class="display_hide" >
            <div class="content_subheader_right mx-4 my-1">

            </div>
        </div>

        <div class="content_body mx-2">
            <div class="popup-container">
<!-- =================== POPUP DATE  =================== -->
                <div id="id_popup_date_container" class="popup_box tsa_bc_lightlightgrey display_hide">
                    <input id="id_popup_date"  type="date" class="input_text popup_box mx-4 my-1" ></input>
                </div>
<!-- =================== POPUP WDY  =================== -->
                 <div id="id_popup_wdy" class="popup_box display_hide td_width_220">
                     <div class="popup_header">
                        <label id="id_popup_wdy_header" class="mx-4 my-1" >{% trans 'Roster date' %}</label>
                        <button id="id_popup_wdy_close" type="button" class="close my-1" aria-label="Close">
                            <span class="popup_close" aria-hidden="true">&times;</span>
                        </button>
                     </div>
                     <div class="content_header_middle">
                        <input id="id_popup_wdy_rosterdate" class="input_text mx-4 my-1" >
                     </div>
                     <div class="content_header_middle" >

                         <button id="id_popup_wdy_prev_month"  class=" btn btn-add" title="{% trans 'Previous month' %}">&#171;</button>
                         <button id="id_popup_wdy_prev_day" class="btn btn-add" title="{% trans 'Previous day' %}">&#8249;</button>
                         <button id="id_popup_wdy_today" class="btn btn-add" >{% trans 'Today' %}</button>
                         <button id="id_popup_wdy_nextday" class="btn btn-add" title="{% trans 'Next day' %}">&#8250;</button>
                         <button id="id_popup_wdy_nextmonth" class="btn btn-add" title="{% trans 'Next month' %}">&#187;</button>

                     </div>
                     <div class="content_subheader_right">
                         <button id="id_popup_wdy_save" class="btn btn-add">{% trans 'Save' %}</button>
                     </div>
                 </div>

<!-- =================== TIMEPICKER  =================== -->
                {% include 'includes/timepicker.html' %}

<!-- =================== DATA TABLE  =================== -->
                    <table class="table table-condensed tsa-tbl mx-4 my-1">

                        <thead id="id_thead_items" class="thead-inverse">
                            <th class="text_align_left">{% trans 'Date' %}</th>
                            <th class="text_align_left">{% trans 'Order' %}</th>
                            <th class="text_align_left">{% trans 'Shift' %}</th>
                            <th class="text_align_left">{% trans 'Employee' %}</th>
                            <th >{% trans 'Start' %}</th>
                            <th>
                                <a id="id_filter_check" href="#" data-value="false" title="{% trans 'Show inactive orders' %}">
                                    <img id="id_img_filter_check" src="{% static 'img/questionmark.gif' %}" height="18" width="18">
                                </a>
                            </th>
                            <th >{% trans 'End' %}</th>
                            <th>
                                <a id="id_filter_check_end" href="#" data-value="false" title="{% trans 'Show inactive orders' %}">
                                  <img id="id_img_filter_check_end" src="{% static 'img/questionmark.gif' %}" height="18" width="18">
                                </a>
                            </th>

                            <th>{% trans 'Break' %}</th>
                            <th>{% trans 'Hours' %}</th>
                            <th>
                                <a id="id_filter_status" href="#" data-value="false" title="{% trans 'Show inactive orders' %}">
                                    <img id="id_img_filter_status" src="{% static 'img/stat04.png' %}" height="18" width="18">
                                </a>
                            </th>
                        </thead>

                        <tbody id="id_tbody_items">
                        </tbody>
                    </table>
  <!-- =================== END DATA TABLE  =================== -->
            </div>

        </div>
  <!--  </div> -->

        <datalist id="id_datalist_orders"></datalist>
        <datalist id="id_datalist_shifts"></datalist>

        <div id="id_data"
            data-imgsrc_inactive_black = "{% static 'img/inactive_black.png' %}"
            data-imgsrc_inactive_lightgrey = "{% static 'img/inactive_lightgrey.png' %}"
            data-imgsrc_active = "{% static 'img/inactive_grey.png' %}"
            data-imgsrc_delete="{% static 'img/delete.gif' %}"
            data-imgsrc_warning="{% static 'img/warning.gif' %}"
            data-imgsrc_questionmark="{% static 'img/questionmark.gif' %}"
            data-imgsrc_stat00="{% static 'img/stat00.png' %}"
            data-imgsrc_stat01="{% static 'img/stat01.png' %}"
            data-imgsrc_stat02="{% static 'img/stat02.png' %}"
            data-imgsrc_stat03="{% static 'img/stat03.png' %}"
            data-imgsrc_stat04="{% static 'img/stat04.png' %}"
            data-imgsrc_stat05="{% static 'img/stat05.png' %}"
            data-imgsrc_real03="{% static 'img/real03.png' %}"

            data-lang ="{{ lang }}"
            data-timezone ="{{ timezone }}"
            data-interval ="{{ interval }}"
            data-timeformat ="{{ timeformat }}"
            data-weekdays ="{{ weekdays }}"
            data-months ="{{ months }}"
            data-today ="{{ today }}"

            data-datalist_download_url="{% url 'datalist_download_url' %}"
            data-emplhour_upload_url="{% url 'emplhour_upload_url' %}"
            data-period_upload_url="{% url 'period_upload_url' %}"
            data-emplhour_fill_rosterdate_url="{% url 'emplhour_fill_rosterdate_url' %}"

            data-err_msg01= "{% trans 'An error occurred.' %}"

            data-txt_save = "{% trans 'Save' %}"
            data-txt_quicksave = "{% trans 'Quick save' %}"
            data-txt_quicksave_remove = "{% trans 'Exit Quick save' %}"

            data-txt_customer = "{% trans 'Customer' %}"
            data-txt_select_customer= "{% trans 'Select customer' %}"
            data-txt_select_customer_none= "{% trans 'No customers' %}"
            data-txt_order= "{% trans 'Order' %}"
            data-txt_select_order= "{% trans 'Select order' %}"
            data-txt_select_order_none= "{% trans 'No orders' %}"

            data-txt_abscat = "{% trans 'Absence category' %}"
            data-txt_select_abscat = "{% trans 'Select absence category' %}"
            data-txt_select_abscat_none = "{% trans 'No absence categories' %}"

            data-txt_date= "{% trans 'Date' %}"
            data-txt_scheme= "{% trans 'Scheme' %}"
            data-txt_scheme_add= "{% trans 'Add new scheme' %}"
            data-txt_cycle_once= "{% trans 'Once only' %}"

            data-txt_period= "{% trans 'Period' %}"
            data-txt_period_setting= "{% trans 'Period setting' %}"
            data-txt_period_all= "{% trans 'all' %}"

            data-txt_period_gotocurr= "{% trans 'Go to current period' %}"
            data-txt_period_gotonext= "{% trans 'Go to next period' %}"
            data-txt_period_gotoprev= "{% trans 'Go to previous period' %}"

            data-txt_range = "{% trans 'Range' %}"
            data-txt_rosterdate= "{% trans 'Rosterdate' %}"
            data-txt_rosterdate_fill = "{% trans 'Fill roster of' %}"
            data-txt_rosterdate_remove = "{% trans 'Remove roster of' %}"
            data-txt_of = "{% trans 'of' %}"
            data-txt_shift= "{% trans 'Shift' %}"

            data-txt_timestart= "{% trans 'Start time' %}"
            data-txt_timeend= "{% trans 'End time' %}"
            data-txt_breakhours= "{% trans 'Break hours' %}"
            data-txt_workinghours= "{% trans 'Working hours' %}"

            data-txt_employee = "{% trans 'Employee' %}"
            data-txt_employee_select= "{% trans 'Select employee' %}"
            data-txt_employee_select_none= "{% trans 'No employees' %}"
            data-txt_employee_replacement= "{% trans 'Replacement employee' %}"
            data-txt_empl_switch_employee= "{% trans 'Employee to be switched with' %}"
            data-txt_empl_switch_date= "{% trans 'Select date' %}"
            data-txt_empl_switch_nodates= "{% trans 'No dates with shifts that can be switched' %}"
            data-txt_empl_switch_shift= "{% trans 'Select shift' %}"
            data-txt_empl_switch_noshifts= "{% trans 'No shifts that can be switched' %}"

            data-txt_datefirst= "{% trans 'Start date' %}"
            data-txt_datelast= "{% trans 'End date' %}"

            data-txt_hour= "{% trans 'hour' %}"
            data-txt_hours= "{% trans 'hours' %}"

            data-txt_employee_add= "{% trans 'Enter employee' %}"

            data-msg_overlap = "{% trans 'This shift overlaps an other shift of this employee' %}"
        >
        </div>

    {% else %}
        <div class="alert alert-danger">{% trans 'Error' %}</div>
        <a href="{% url 'home' %}" class="btn btn-outline-primary">{% trans 'Cancel' %}</a>
    {% endif %}
{% endblock %}